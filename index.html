<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Omar Saleh - Data Analyst & Business Intelligence Expert</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #1e40af;
            --dark: #1e293b;
            --light: #f8fafc;
            --text: #475569;
            --accent: #10b981;
            --card-bg: #ffffff;
            --shadow-color: rgba(0, 0, 0, 0.08);
            --border-color: #dee2e6;
            --bg-main: #f8f9fa;
            --nav-bg: rgba(255, 255, 255, 0.95);
            --hero-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        [data-theme="dark"] {
            --primary: #3b82f6;
            --secondary: #60a5fa;
            --dark: #f1f5f9;
            --light: #1e293b;
            --text: #cbd5e1;
            --accent: #34d399;
            --card-bg: #334155;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --border-color: #475569;
            --bg-main: #0f172a;
            --nav-bg: rgba(15, 23, 42, 0.95);
            --hero-gradient: linear-gradient(135deg, #4338ca 0%, #7c3aed 100%);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            overflow-x: hidden;
            background-color: var(--bg-main);
            transition: all 0.3s ease;
        }
        
        html {
            scroll-behavior: smooth;
        }

        /* Dark Mode Toggle Button */
        .theme-toggle {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--primary);
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            z-index: 999;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: var(--nav-bg);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            z-index: 1000;
            padding: 1rem 0;
            transition: all 0.3s ease;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        /* Hero Section with Profile Photo */
        .hero {
            padding-top: 80px;
            min-height: 100vh;
            background: var(--hero-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .hero-content {
            text-align: center;
            color: white;
            z-index: 1;
            max-width: 900px;
            padding: 0 1rem;
        }

        .profile-photo-container {
            margin-bottom: 2rem;
            position: relative;
            display: inline-block;
        }

        .profile-photo {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .profile-photo:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
        }

        .profile-photo-placeholder {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
            border: 5px solid rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: white;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .hero h1 {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .hero .subtitle {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            opacity: 0.9;
        }

        /* USP Section */
        .usp-banner {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2rem;
            border-radius: 20px;
            margin: 2rem auto;
            max-width: 800px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .usp-banner h3 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: #ffd700;
        }

        .usp-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .usp-point {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
        }

        .usp-point::before {
            content: 'âœ¨';
            font-size: 1.2rem;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-weight: 600;
        }

        .btn-primary {
            background: white;
            color: var(--primary);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        /* Section Styles */
        section {
            padding: 5rem 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .section-title {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 3rem;
            color: var(--dark);
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 2px;
        }

        /* About Section */
        #about {
            background: var(--light);
        }

        .about-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
        }

        .about-text p {
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            line-height: 1.8;
        }

        .expertise-list {
            list-style: none;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .expertise-list li {
            padding: 0.5rem;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .expertise-list li:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .expertise-list li::before {
            content: 'âœ“';
            color: var(--accent);
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .education-card {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .education-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .education-card h3 {
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .education-card .year {
            color: var(--accent);
            font-weight: bold;
        }

        /* Skills Section */
        #skills {
            background: var(--card-bg);
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .skill-category {
            background: var(--light);
            padding: 2rem;
            border-radius: 15px;
            transition: all 0.3s ease;
        }
        
        .skill-category:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .skill-category h3 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .skill-tag {
            background: var(--primary);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        /* Portfolio Section */
        #portfolio {
            background-color: var(--light);
        }
        
        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 35px;
        }
        
        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px var(--shadow-color);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 25px var(--shadow-color);
        }
        
        .card-img {
            width: 100%;
            height: 240px;
            object-fit: cover;
            display: block;
            cursor: pointer;
        }
        
        .card-body {
            padding: 25px;
            flex-grow: 1;
            /* MODIFICATION: Make the body a flex container to manage its children */
            display: flex;
            flex-direction: column;
        }
        
        .card-title {
            margin-top: 0;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--dark);
        }
        
        .card-desc {
            font-size: 1rem;
            color: var(--text);
            margin: 0;
            /* MODIFICATION: Allow the description to grow and push the card taller */
            flex-grow: 1;
        }

        /* Contact Section */
        #contact {
            background: var(--hero-gradient);
            color: white;
            text-align: center;
        }

        #contact .section-title, #contact .section-title::after {
            color: white;
            background: white;
        }

        .contact-info {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .contact-item:hover {
            transform: scale(1.1);
        }
        
        .contact-item a {
            color: white;
            text-decoration: none;
        }

        /* Lightbox Design */
        .lightbox {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.88);
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        }
        
        .lightbox.visible {
            display: flex;
        }
        
        .lightbox-container {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .lightbox-content {
            max-width: 100%;
            max-height: 65vh;
            border-radius: 8px;
            object-fit: contain;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 25px;
            color: var(--dark);
            font-size: 35px;
            font-weight: bold;
            cursor: pointer;
            z-index: 10;
        }
        
        .gemini-controls {
            padding-top: 15px;
            text-align: center;
        }
        
        .gemini-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .gemini-btn:hover {
            background-color: var(--secondary);
        }
        
        .gemini-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        #analysis-result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            background-color: var(--light);
            color: var(--text);
            max-height: 20vh;
            overflow-y: auto;
            text-align: left;
            white-space: pre-wrap;
        }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 15px auto;
            display: none;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            .hero .subtitle { font-size: 1.2rem; }
            .about-content { grid-template-columns: 1fr; }
            .nav-links { display: none; }
            .contact-info { flex-direction: column; gap: 1rem; }
            section { padding: 4rem 1rem; }
            .usp-points { grid-template-columns: 1fr; }
            .expertise-list { grid-template-columns: 1fr; }
            .profile-photo, .profile-photo-placeholder { 
                width: 150px; 
                height: 150px; 
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
        <span id="themeIcon">ðŸŒ™</span>
    </button>

    <nav>
        <div class="nav-container">
            <a href="#home" class="logo">Omar Saleh</a>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#skills">Skills</a></li>
                <li><a href="#portfolio">My Work</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </div>
    </nav>

    <section class="hero" id="home">
        <div class="hero-content">
            <div class="profile-photo-container">
                 <img src="5778649785920767876 (1).jpg" alt="Omar Saleh" class="profile-photo">
            </div>
            
            <h1>Omar Saleh</h1>
            <p class="subtitle">Data Analyst & Business Intelligence Specialist</p>
            
            <div class="usp-banner">
                <h3>Why Choose Me?</h3>
                <div class="usp-points">
                    <div class="usp-point">NTI-Certified Data Analyst</div>
                    <div class="usp-point">Power BI & Python Expert</div>
                    <div class="usp-point">Professional Business Expert</div>
                    <div class="usp-point">Freelance Ready</div>
                    <div class="usp-point">Bilingual Professional</div>
                </div>
            </div>
            
            <div class="cta-buttons">
                <a href="#portfolio" class="btn btn-primary">Explore My Work</a>
                <a href="https://www.linkedin.com/in/omar-saleh-049045187/" target="_blank" class="btn btn-secondary">LinkedIn Profile</a>
            </div>
        </div>
    </section>

    <section id="about">
        <div class="container">
            <h2 class="section-title">About Me</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>As a skilled Data Analyst with comprehensive training from the National Telecommunications Institute (NTI) and hands-on experience through Banque Masr's elite internship program, I specialize in transforming complex data into strategic business insights.</p>
                    <p>Currently completing my Bachelor's degree in Commerce (Accounting), I bring a unique blend of financial acumen and technical expertise to deliver data-driven solutions.</p>
                    <h3>Core Competencies:</h3>
                    <ul class="expertise-list">
                        <li>Advanced Data Analytics</li>
                        <li>Business Intelligence (Power BI)</li>
                        <li>Python & SQL Programming</li>
                        <li>ETL & Data Warehousing</li>
                        <li>Financial Analysis & Reporting</li>
                        <li>Dashboard Development</li>
                    </ul>
                </div>
                <div class="about-image">
                    <div class="education-card">
                        <h3>Faculty of Commerce (English)</h3>
                        <p class="year">2021 - 2025</p>
                        <p>Menoufia University</p>
                        <p><strong>Grade: Very Good</strong></p>
                    </div>
                    <div class="education-card">
                        <h3>Data Analysis Professional Training</h3>
                        <p class="year">2024 - 2025</p>
                        <p>National Telecommunications Institute (NTI)</p>
                        <p><strong>Specialization: Freelance Data Analysis</strong></p>
                    </div>
                    <div class="education-card">
                        <h3>Banking Internship</h3>
                        <p class="year">2023</p>
                        <p>Banque Masr - Pioneers Program</p>
                        <p><strong>Multi-Department Rotation</strong></p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="skills">
        <div class="container">
            <h2 class="section-title">Technical Expertise</h2>
            <div class="skills-grid">
                <div class="skill-category">
                    <h3>Data Analysis Tools</h3>
                    <p>Proficient in industry-standard tools for data manipulation, visualization, and reporting.</p>
                    <div class="skill-tags">
                        <span class="skill-tag">Power BI</span>
                        <span class="skill-tag">Advanced Excel</span>
                        <span class="skill-tag">Power Query</span>
                        <span class="skill-tag">Power Pivot</span>
                        <span class="skill-tag">DAX</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>Programming & Databases</h3>
                    <p>Strong foundation in programming languages and database management systems.</p>
                    <div class="skill-tags">
                        <span class="skill-tag">Python (Pandas, NumPy)</span>
                        <span class="skill-tag">SQL</span>
                        <span class="skill-tag">Data Modeling</span>
                        <span class="skill-tag">ETL Processes</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>Business Applications</h3>
                    <p>Experience with enterprise software and business process optimization.</p>
                    <div class="skill-tags">
                        <span class="skill-tag">Odoo ERP</span>
                        <span class="skill-tag">Financial Reporting</span>
                        <span class="skill-tag">MOS Certified</span>
                        <span class="skill-tag">Data Warehousing</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>Soft Skills</h3>
                    <p>Professional competencies that enhance team collaboration and project success.</p>
                    <div class="skill-tags">
                        <span class="skill-tag">Problem-Solving</span>
                        <span class="skill-tag">Client Communication</span>
                        <span class="skill-tag">Team Leadership</span>
                        <span class="skill-tag">Project Management</span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section id="portfolio">
        <div class="container">
            <h2 class="section-title">Data Analytics Portfolio</h2>
            <div id="portfolio-grid" class="portfolio-grid"></div>
        </div>
    </section>

    <section id="contact">
        <div class="container">
            <h2 class="section-title">Let's Connect</h2>
            <p style="font-size: 1.3rem; margin-bottom: 2rem;">Ready to transform your data into actionable insights?</p>
            <div class="contact-info">
                <div class="contact-item">
                    <span>ðŸ“§</span>
                    <a href="mailto:omar.saleh.9959@gmail.com">omar.saleh.9959@gmail.com</a>
                </div>
                <div class="contact-item">
                    <span>ðŸ“±</span>
                    <a href="tel:+201029819161">+201029819161</a>
                </div>
                <div class="contact-item">
                    <span>ðŸ’¼</span>
                    <a href="https://www.linkedin.com/in/omar-saleh-049045187/" target="_blank">LinkedIn</a>
                </div>
            </div>
        </div>
    </section>
    
    <div id="lightbox" class="lightbox">
        <div class="lightbox-container">
            <span class="close-btn">&times;</span>
            <img class="lightbox-content" id="lightbox-img">
            <div class="gemini-controls">
                <button id="analyze-btn" class="gemini-btn">âœ¨ Analyze Dashboard with AI</button>
            </div>
            <div id="loader" class="loader"></div>
            <div id="analysis-result"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // Dark Mode Toggle
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const htmlElement = document.documentElement;
            
            // Check for saved theme preference
            const currentTheme = localStorage.getItem('theme') || 'light';
            htmlElement.setAttribute('data-theme', currentTheme);
            themeIcon.textContent = currentTheme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
            
            themeToggle.addEventListener('click', () => {
                const currentTheme = htmlElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                htmlElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                themeIcon.textContent = newTheme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
            });
            
// Portfolio Projects - KEEPING ORIGINAL IMAGE NAMES
const projects = [
    {
        title: "Sales Analysis Dashboard",
        img: "Screenshot 2024-12-07 163948.png",
        desc: "An interactive Power BI dashboard designed to provide a 360-degree view of sales operations. It tracks KPIs like total sales, profit margins, and sales growth, with detailed analyses by region, product, and customer segment to identify growth opportunities.",
        skills: ["Power BI", "DAX", "Data Modeling", "Data Visualization", "Power Query (ETL)", "Business Intelligence"]
    },
    {
        title: "HR Analytics Dashboard",
        img: "Screenshot 2025-08-31 213552.png",
        desc: "A dynamic Power BI dashboard offering deep insights into workforce analytics. It visualizes critical HR metrics like employee turnover, average tenure, recruitment funnels, and performance ratings to support data-driven talent management decisions.",
        skills: ["Power BI", "DAX", "Data Visualization", "HR Analytics", "KPI Dashboards", "Data Storytelling"]
    },
    {
        title: "Order & Inventory Analysis Dashboard",
        img: "Screenshot 2025-01-02 234607.png",
        desc: "An integrated dashboard providing a real-time view of stock levels, order status, and supply chain movements. It includes predictive models to forecast demand, identify re-order points, and prevent stockouts, significantly improving efficiency.",
        skills: ["Power BI", "Supply Chain Analytics", "Inventory Management", "Predictive Analytics", "Data Integration", "DAX"]
    },
    {
        title: "Comprehensive Financial Analysis in Excel",
        img: "Screenshot 2025-04-03 230707.png",
        desc: "A sophisticated financial model built in Excel, featuring dynamic P&L, Balance Sheet, and Cash Flow statements. Leverages Power Query for data transformation (ETL) and DAX within the Excel Data Model for robust, multi-dimensional analysis.",
        skills: ["Advanced Excel", "Power Query", "Power Pivot", "DAX", "Financial Modeling", "Data Analysis", "Financial Reporting"]
    },
    {
        title: "Digital Marketing Campaign Analysis",
        img: "Screenshot 2025-05-01 155410.jpg",
        desc: "A data-driven dashboard evaluating digital marketing performance by integrating data from Google Analytics and ad platforms. It focuses on key metrics like ROI, Customer Acquisition Cost (CAC), and conversion rates to optimize ad spend and maximize effectiveness.",
        skills: ["Power BI", "Marketing Analytics", "Data Integration (APIs)", "Funnel Analysis", "ROI Analysis", "Data Visualization"]
    }
];

            const portfolioGrid = document.getElementById('portfolio-grid');
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            const closeBtn = document.querySelector('.close-btn');
            const analyzeBtn = document.getElementById('analyze-btn');
            const analysisResult = document.getElementById('analysis-result');
            const loader = document.getElementById('loader');

            projects.forEach(project => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <img src="${project.img}" alt="${project.title}" class="card-img">
                    <div class="card-body">
                        <h3 class="card-title">${project.title}</h3>
                        <p class="card-desc">${project.desc}</p>
                    </div>
                `;

                const cardImg = card.querySelector('.card-img');
                cardImg.addEventListener('click', () => {
                    lightbox.classList.add('visible');
                    lightboxImg.src = cardImg.src;
                    analysisResult.innerHTML = ''; // Clear previous results
                    analyzeBtn.disabled = false;
                });

                portfolioGrid.appendChild(card);
            });

            // --- Lightbox Functionality ---
            closeBtn.addEventListener('click', () => {
                lightbox.classList.remove('visible');
            });

            lightbox.addEventListener('click', (e) => {
                // Close if the user clicks on the dark background
                if (e.target === lightbox) {
                    lightbox.classList.remove('visible');
                }
            });

            // --- Mock AI Analysis Functionality ---
            // This function simulates a call to an AI model
            function mockApiCall(imageSrc) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        let analysisText = "AI analysis is not available for this dashboard yet. Please check back later.";
                        
                        if (imageSrc.includes("163948.png")) { // Sales
                            analysisText = "AI Analysis: This sales dashboard effectively tracks KPIs like total revenue and profit margin. Key insights indicate a strong performance in the 'Technology' category. Recommendation: Investigate the low-performing 'Office Supplies' sub-category to identify opportunities for growth.";
                        } else if (imageSrc.includes("213552.png")) { // HR
                            analysisText = "AI Analysis: The HR dashboard highlights a high employee turnover rate in the 'Sales' department. The male-to-female ratio is well-balanced. Recommendation: Conduct exit interviews for the sales department to understand the reasons for attrition and implement retention strategies.";
                        } else if (imageSrc.includes("234607.png")) { // Inventory
                            analysisText = "AI Analysis: This dashboard shows a clear correlation between order quantity and shipping costs. 'Standard Class' is the most used shipping mode. Recommendation: Explore bulk shipping discounts with carriers for high-volume products to reduce overall logistics expenses.";
                        } else if (imageSrc.includes("230707.png")) { // Excel
                            analysisText = "AI Analysis: The Excel financial model demonstrates strong data integration using Power Query. The pivot tables effectively summarize monthly expenses. Recommendation: Implement conditional formatting to automatically highlight budget variances exceeding 10% for quicker identification of issues.";
                        } else if (imageSrc.includes("155410.jpg")) { // Marketing
                            analysisText = "AI Analysis: This marketing dashboard reveals that the 'Facebook Ads' campaign has the highest Customer Acquisition Cost (CAC) but also the highest conversion rate. Recommendation: Optimize ad spend by reallocating a portion of the budget from lower-performing channels to Facebook, while A/B testing ad creatives to lower CAC.";
                        }
                        
                        resolve(analysisText);
                    }, 1500); // Simulate network delay of 1.5 seconds
                });
            }

            analyzeBtn.addEventListener('click', async () => {
                analysisResult.innerHTML = '';
                loader.style.display = 'block';
                analyzeBtn.disabled = true;

                const analysisText = await mockApiCall(lightboxImg.src);

                loader.style.display = 'none';
                analysisResult.textContent = analysisText;
                analyzeBtn.disabled = false;
            });

        });
    </script>
</body>
</html>
